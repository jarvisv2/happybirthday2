<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="title" content="Happy Birthday | darkshadeoflove" />
  <title>Happy Birthday | darkshadeoflove</title>

  <!-- Existing CSS -->
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- jQuery (already referenced in your code) -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="darkshadeoflove"></script>

  <!-- Mobile-first enhancements -->
  <style>
    :root {
      --bg: #0b0b0f;
      --card: #151521;
      --accent: #ff4d6d;
      --accent-2: #ffb703;
      --text: #ffffff;
    }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      touch-action: manipulation;
    }

    /* 1) Splash countdown */
    #splash {
      position: fixed;
      inset: 0;
      background:
        radial-gradient(1200px 600px at 50% -20%, #1a1030 10%, transparent 60%) no-repeat,
        linear-gradient(180deg, #0b0b0f, #0f0f1a);
      display: grid;
      place-items: center;
      z-index: 9999;
    }
    .splash-inner {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      text-align: center;
      padding: 20px 24px;
    }
    .splash-title {
      font-size: 18px;
      opacity: 0.9;
      letter-spacing: 0.4px;
    }
    #countdown {
      font-size: 56px;
      line-height: 1;
      font-weight: 700;
      letter-spacing: 2px;
      background: linear-gradient(90deg, #ff7aa2, #ffd166);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 10px 30px rgba(255, 122, 162, 0.25);
    }
    .splash-sub {
      font-size: 14px;
      opacity: 0.8;
    }

    /* 2) Hidden inline YouTube player: visible to the browser, invisible to user */
    .player-wrap {
      position: fixed;
      width: 1px;
      height: 1px;
      opacity: 0;
      pointer-events: none;
      bottom: 0;
      right: 0;
      z-index: -1;
    }

    /* 3) Cake stage (before revealing your original page) */
    #cakeStage {
      position: fixed;
      inset: 0;
      background: linear-gradient(180deg, #0b0b0f 0%, #17172a 100%);
      display: none; /* shown after countdown */
      z-index: 9500;
      padding: 24px;
      box-sizing: border-box;
    }
    .cake-wrap {
      max-width: 480px;
      margin: 0 auto;
      display: grid;
      align-content: center;
      justify-items: center;
      gap: 18px;
      height: 100%;
    }
    .stage-title {
      font-size: 20px;
      opacity: 0.95;
    }
    .primary-btn, .ghost-btn {
      -webkit-tap-highlight-color: transparent;
      appearance: none;
      border: none;
      outline: none;
      padding: 12px 16px;
      border-radius: 12px;
      font-weight: 600;
      letter-spacing: 0.3px;
      cursor: pointer;
    }
    .primary-btn {
      background: linear-gradient(90deg, #ff4d6d, #ffb703);
      color: #0b0b0f;
      box-shadow: 0 8px 20px rgba(255, 77, 109, 0.25);
    }
    .ghost-btn {
      background: transparent;
      color: #ffffff;
      border: 1px solid rgba(255,255,255,0.15);
    }

    /* Simple, crisp CSS cake */
    .cake {
      position: relative;
      width: 220px;
      height: 200px;
      display: grid;
      place-items: end center;
      filter: drop-shadow(0 10px 30px rgba(0,0,0,0.35));
    }
    .cake .layer {
      width: 220px;
      height: 66px;
      background:
        linear-gradient(180deg, #ffe3ea 0%, #ffc0cf 100%);
      border-radius: 10px;
      position: relative;
      box-shadow: inset 0 -6px 0 rgba(0,0,0,0.06);
    }
    .cake .layer + .layer { margin-top: -8px; }
    .cake .drip {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 22px;
      background:
        radial-gradient(12px 9px at 16px 10px, #ff7aa2 60%, transparent 61%) repeat-x;
      background-size: 28px 22px;
      background-position: 0 0;
      filter: drop-shadow(0 3px 0 rgba(0,0,0,0.08));
    }
    .cake .top {
      width: 180px;
      height: 36px;
      background: #ffeef3;
      border-radius: 18px;
      margin-bottom: -6px;
      box-shadow: inset 0 -6px 0 rgba(0,0,0,0.06);
      position: relative;
      display: grid;
      place-items: center;
    }
    /* Candle */
    .candle {
      width: 12px;
      height: 42px;
      background:
        repeating-linear-gradient(45deg, #fd3018 0 6px, #ffa89e 6px 12px);
      border-radius: 6px;
      position: absolute;
      top: -38px;
      left: 50%;
      transform: translateX(-50%);
      box-shadow: 0 6px 10px rgba(0,0,0,0.15);
    }
    .flame {
      position: absolute;
      width: 14px;
      height: 20px;
      background: radial-gradient(circle at 50% 35%, #ffd166 30%, #ff8a00 70%);
      border-radius: 50% 50% 45% 45%;
      top: -18px;
      left: 50%;
      transform: translateX(-50%);
      animation: flicker 0.9s infinite alternate ease-in-out;
      filter: drop-shadow(0 0 12px rgba(255, 153, 0, 0.7));
      transform-origin: 50% 100%;
    }
    @keyframes flicker {
      0% { transform: translateX(-50%) rotate(-2deg) scale(1); opacity: 0.9; }
      100% { transform: translateX(-50%) rotate(2deg) scale(1.04); opacity: 1; }
    }

    /* Slice (triangular wedge) */
    .slice {
      position: absolute;
      width: 0;
      height: 0;
      border-left: 60px solid transparent;
      border-right: 10px solid transparent;
      border-top: 60px solid #ffc0cf;
      top: 52px;
      left: 22px;
      transform-origin: 0 100%;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,0.2));
      transition: transform 850ms cubic-bezier(.2,.7,.2,1), opacity 300ms ease;
    }
    .slice::after {
      content: "";
      position: absolute;
      top: -60px;
      left: -58px;
      width: 70px;
      height: 10px;
      background: #ffe3ea;
      border-radius: 6px;
      box-shadow: inset 0 -3px 0 rgba(0,0,0,0.06);
    }

    /* Knife just for fun */
    .knife {
      position: absolute;
      width: 120px;
      height: 6px;
      background: linear-gradient(90deg, #c0c6cf, #e4e8ee);
      border-radius: 3px;
      right: -14px;
      top: 66px;
      transform: rotate(18deg);
      box-shadow: 0 2px 8px rgba(0,0,0,0.25);
      opacity: 0;
      transition: opacity 250ms ease;
    }

    /* Cutting state */
    .cake.cut .knife { opacity: 1; }
    .cake.cut .slice {
      transform: translate(120px, -40px) rotate(18deg);
    }
    .cake.cut .flame {
      opacity: 0;
      transition: opacity 240ms ease;
    }

    /* Reveal your original wrapper after cake */
    #wrapper { display: none; }

    /* Small helpers */
    .hint {
      font-size: 12px;
      opacity: 0.7;
    }

    /* Respect reduced motion */
    @media (prefers-reduced-motion: reduce) {
      .flame, .slice { animation: none; transition: none; }
    }
  </style>
</head>
<body>
  <!-- 1) Splash countdown -->
  <div id="splash" role="dialog" aria-label="Starting soon">
    <div class="splash-inner">
      <div class="splash-title">Starting in</div>
      <div id="countdown">5</div>
      <div class="splash-sub">Please keep sound on; music starts muted by policy and will unmute on cake cut.</div>
    </div>
  </div>

  <!-- 2) Minimal player surface (autoplay muted, inline) -->
  <div class="player-wrap">
    <div id="ytPlayer" aria-hidden="true"></div>
  </div>

  <!-- 3) Cake stage -->
  <section id="cakeStage" aria-live="polite">
    <div class="cake-wrap">
      <div class="stage-title">Happy Birthday, Supriya üéÇ</div>
      <div class="cake" id="cake">
        <div class="top">
          <div class="candle">
            <div class="flame"></div>
          </div>
        </div>
        <div class="layer"><div class="drip"></div></div>
        <div class="layer"><div class="drip"></div></div>
        <div class="layer"><div class="drip"></div></div>
        <div class="slice"></div>
        <div class="knife"></div>
      </div>

      <button id="cutCakeBtn" class="primary-btn">Cut the Cake</button>
      <button id="tapToStartBtn" class="ghost-btn" style="display:none;">Tap to start music</button>
      <div class="hint">After cutting, your surprise page opens.</div>
    </div>
  </section>

  <!-- 4) YOUR ORIGINAL CONTENT (unchanged, just follows the cake) -->
  <div id="wrapper">
      <div class="flag__birthday">
          <img src="./images/1.png" alt="" width="350" class="flag__left">
          <img src="./images/1.png" alt="" width="350" class="flag__right">
      </div>
      <div class="content">
          <div class="left">
              <div class="title">
                  <h1 class="happy">
                      <span style="--t: 4s;">H</span>
                      <span style="--t: 4.2s;">a</span>
                      <span style="--t: 4.4s;">p</span>
                      <span style="--t: 4.6s;">p</span>
                      <span style="--t: 4.8s;">y</span>
                  </h1>
                  <h1 class="birthday">
                      <span style="--t: 5s;">B</span>
                      <span style="--t: 5.2s;">i</span>
                      <span style="--t: 5.4s;">r</span>
                      <span style="--t: 5.6s;">t</span>
                      <span style="--t: 5.8s;">h</span>
                      <span style="--t: 6s;">d</span>
                      <span style="--t: 6.2s;">a</span>
                      <span style="--t: 6.4s;">y</span>
                  </h1>
                  <div class="hat">
                      <img src="./images/hat.png" alt="" width="130">
                  </div>
              </div>
              <div class="date__of__birth">
                  <span></span>
              </div>
              <div class="btn">
                  <button id="btn__letter">
                      Click here Supriya ‚ù§Ô∏è
                      <i class="fa-regular fa-envelope"></i>
                  </button>
              </div>
          </div>
          <div class="right">
              <div class="box__account">
                  <div class="image">
                      <img src="./images/r5.png" alt="">
                  </div>
                  <div class="name">
                      <i class="fa-solid fa-heart"></i>
                      <span>darkshadeoflove</span>
                      <i class="fa-solid fa-heart"></i>
                  </div>
                  <div class="balloon_one">
                      <img width="100px" src="./images/balloon1.png" alt="">
                  </div>
                  <div class="balloon_two">
                      <img width="100px" src="./images/balloon2.png" alt="">
                  </div>
              </div>
              <div class="cricle">
                  <div class="text__cricle">
                      <span style="--i: 1;">h</span>
                      <span style="--i: 2;">a</span>
                      <span style="--i: 3;">p</span>
                      <span style="--i: 4;">p</span>
                      <span style="--i: 5;">y</span>
                      <span style="--i: 6;">-</span>
                      <span style="--i: 7;">b</span>
                      <span style="--i: 8;">i</span>
                      <span style="--i: 9;">r</span>
                      <span style="--i: 10;">t</span>
                      <span style="--i: 11;">h</span>
                      <span style="--i: 12;">d</span>
                      <span style="--i: 13;">a</span>
                      <span style="--i: 14;">y</span>
                      <span style="--i: 15;">-</span>
                  </div>
                  <i class="fa-solid fa-heart"></i>
              </div>
          </div>
      </div>
      <div class="decorate_star star1" style="--t: 15s;"></div>
      <div class="decorate_star star2" style="--t: 15.2s;"></div>
      <div class="decorate_star star3" style="--t: 15.4s;"></div>
      <div class="decorate_star star4" style="--t: 15.6s;"></div>
      <div class="decorate_star star5" style="--t: 15.8s;"></div>
      <div class="decorate_flower--one" style="--t: 15s;">
          <img width="20" src="./images/decorate_flower.png" alt="">
      </div>
      <div class="decorate_flower--two" style="--t: 15.3s;">
          <img width="20" src="./images/decorate_flower.png" alt="">
      </div>
      <div class="decorate_flower--three" style="--t: 15.6s;">
          <img width="20" src="./images/decorate_flower.png" alt="">
      </div>
      <div class="decorate_bottom">
          <img src="./images/decorate.png" alt="" width="100">
      </div>
      <div class="smiley__icon">
          <img src="./images/smiley_icon.png" alt="" width="100">
      </div>

      <div class="box__letter">
          <div class="letter__border">
              <div class="letter">
                  <div class="title__letter"></div>
                  <div class="content__letter">
                      <div class="left">
                          <img id="heart__letter" src="https://media.giphy.com/media/YKUvclrGYmDKXwtphf/giphy.gif" alt="">
                          <img class="heart heart_1" style="--t: 0.2s" width="20" src="./images/heart.png" alt="">
                          <img class="heart heart_2" style="--t: 0.4s" width="20" src="./images/heart.png" alt="">
                          <img class="heart heart_3" style="--t: 0.6s" width="20" src="./images/heart.png" alt="">
                          <img class="heart heart_4" style="--t: 0.8s" width="20" src="./images/heart.png" alt="">
                      </div>
                      <div class="right">
                          <div class="love__img">
                              <img src="https://media.giphy.com/media/m85llaN7ZkFIHtURiC/giphy.gif" alt="" width="220">
                          </div>
                          <div class="text__letter">
                              <p></p>
                          </div>
                          <img id="mewmew" width="80" src="./images/mewmew.gif" alt="">
                      </div>
                  </div>
              </div>
              <div class="close">
                  <i class="fa-solid fa-xmark"></i>
              </div>
          </div>
      </div>
  </div>

  <div id="copy">
    <p class="text-center text-white text-sm">darkshadeoflove <a href="https://www.instagram.com/darkshadeoflove">@darkshadeoflove</a></p>
  </div>

  <!-- YouTube IFrame API -->
  <script src="https://www.youtube.com/iframe_api"></script>

  <script>
    // Fill missing variable from your original script to avoid errors
    const titleLetter = "For Supriya";

    // Your desired date and letter text
    let datetxt = "2 Nov 1999";
    let datatxtletter = "Happy birthday to the most beautiful, special girl in my heart. May your birthday be as beautiful and special as you are. Wishing you all the happiness your heart can hold on your special day.üíï";

    // Countdown splash
    let cd = 5;
    const cdEl = document.getElementById("countdown");
    const splash = document.getElementById("splash");
    const cakeStage = document.getElementById("cakeStage");

    // YouTube player
    let player = null;
    function onYouTubeIframeAPIReady() {
      player = new YT.Player('ytPlayer', {
        videoId: 'kcGojPJzh1k',
        width: '300',
        height: '150',
        playerVars: {
          autoplay: 1,
          controls: 0,
          disablekb: 1,
          playsinline: 1,
          rel: 0,
          modestbranding: 1
        },
        events: {
          'onReady': (ev) => {
            try {
              ev.target.mute(); // start muted for policy compliance
            } catch (e) {}
          }
        }
      });
    }

    // Start countdown immediately
    const cdTimer = setInterval(() => {
      cdEl.textContent = cd;
      if (cd <= 0) {
        clearInterval(cdTimer);
        // Hide splash, show cake stage
        splash.style.display = "none";
        cakeStage.style.display = "block";

        // Attempt to play (muted)
        const tryPlay = () => {
          try { player && player.playVideo && player.playVideo(); } catch(e){}
        };
        tryPlay();

        // Fallback hint: if not playing after a moment, show tap button
        setTimeout(() => {
          try {
            const state = player && player.getPlayerState ? player.getPlayerState() : -1;
            if (state !== 1) {
              document.getElementById("tapToStartBtn").style.display = "inline-flex";
            }
          } catch(e){}
        }, 900);
      }
      cd--;
    }, 1000);

    // Tap-to-start fallback
    document.getElementById("tapToStartBtn").addEventListener("click", () => {
      try { player && player.playVideo && player.playVideo(); } catch(e){}
      document.getElementById("tapToStartBtn").style.display = "none";
    });

    // Cake cutting
    const cutBtn = document.getElementById("cutCakeBtn");
    const cake = document.getElementById("cake");
    cutBtn.addEventListener("click", () => {
      cake.classList.add("cut");

      // Unmute & set volume on user gesture
      try {
        if (player && player.unMute) {
          player.unMute();
          player.setVolume(70);
          player.playVideo();
        }
      } catch(e){}

      // After animation, reveal original wrapper and remove the cake stage
      setTimeout(() => {
        document.getElementById("wrapper").style.display = "block";
        cakeStage.style.display = "none";
      }, 1200);
    });
  </script>

  <!-- Your original script (kept, with titleLetter now defined above) -->
  <script>
    let charArrDate = datetxt.split('');
    let charArrDateLetter = datatxtletter.split('');
    let charArrTitle = titleLetter.split('');
    let currentIndex = 0;
    let currentIndexLetter = 0;
    let currentIndexTitle = 0;
    let date__of__birth = document.querySelector(".date__of__birth span");
    let text__letter = document.querySelector(".text__letter p");
    setTimeout(function(){
        timeDatetxt = setInterval(function(){
            if(currentIndex < charArrDate.length){
                date__of__birth.textContent += charArrDate[currentIndex];
                currentIndex++;
            }
            else{
                let i = document.createElement("i");
                i.className = "fa-solid fa-star"
                document.querySelector(".date__of__birth").prepend(i)
                document.querySelector(".date__of__birth").appendChild(i.cloneNode(true))
                clearInterval(timeDatetxt)
            }
        },100)
    },12000)

    var intervalContent;
    var intervalTitle;
    $("#btn__letter").on("click", function(){
        $(".box__letter").slideDown()
        setTimeout(function(){
            $(".letter__border").slideDown();
        },1000)
        setTimeout(function(){
            intervalTitle = setInterval(function(){
                if(currentIndexTitle < charArrTitle.length){
                    document.querySelector(".title__letter").textContent += charArrTitle[currentIndexTitle];
                    let i = document.createElement("i");
                    i.className = "fa-solid fa-heart"
                    document.querySelector(".title__letter").appendChild(i)
                    currentIndexTitle++;
                }
                else{
                    clearInterval(intervalTitle)
                }
            },100)
        },2000)
        setTimeout(function(){
            document.querySelector("#heart__letter").classList.add("animationOp");
            document.querySelector(".love__img").classList.add("animationOp");
            document.querySelector("#mewmew").classList.add("animationOp");
        },2800)
        setTimeout(function(){
            document.querySelectorAll(".heart").forEach((item)=>{
                item.classList.add("animation")
            })
        },3500)
        setTimeout(function(){
            intervalContent = setInterval(function(){
                if(currentIndexLetter < charArrDateLetter.length){
                    text__letter.textContent += charArrDateLetter[currentIndexLetter];
                    currentIndexLetter++;
                }
                else{
                    clearInterval(intervalContent)
                }
            },50)
        },6000)
    })
    $(".close").on("click", function(){
        clearInterval(intervalContent)
        document.querySelector(".title__letter").textContent = "";
        text__letter.textContent = "";
        currentIndexLetter = 0
        currentIndexTitle = 0
        document.querySelector("#heart__letter").classList.remove("animationOp");
        document.querySelector(".love__img").classList.remove("animationOp");
        document.querySelector("#mewmew").classList.remove("animationOp");
        document.querySelectorAll(".heart").forEach((item)=>{
                item.classList.remove("animation")
            })
        $(".box__letter").slideUp();
        $(".letter__border").slideUp();
    })
  </script>
</body>
</html>
